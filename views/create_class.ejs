<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width; initial-scale = 1.0; maximum-scale=1.0; user-scalable=no" />
	<script src="../static/js/jquery-1.12.4.min.js"></script>
	<script src="../static/js/bootstrap.min.js"></script>
	<link rel="stylesheet" type="text/css" href="../static/css/bootstrap-theme.min.css">
	<link rel="stylesheet" type="text/css" href="../static/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../static/css/font-awesome.min.css">

	<!--google fonts-->
	<link href="https://fonts.googleapis.com/css?family=Quattrocento+Sans" rel="stylesheet">


	<link rel="stylesheet" type="text/css" href="../static/css/style.css">

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../static/js/moment.min.js"></script>

 	<title>FITTED web <%= app_version %></title>
</head>
<%var class_data = JSON.parse(JSON.stringify(class_preferences))%>
<body style='background-color: #0AD981; color: #FFF;'>
<!--facebook code-->
<script>
var isNumberKey = function(evt){
          var charCode = (evt.which) ? evt.which : evt.keyCode;
          if (charCode != 46 && charCode > 31 
            && (charCode < 48 || charCode > 57))
             return false;
          return true;
    }

$(document).ready(function(){

	var statusChangeCallback = function(response){
		console.log(response);
	}

	function checkLoginState() {
		FB.login(function(response){
			console.log(response);
		});
	}

	window.fbAsyncInit = function() {
		FB.init({
		  appId      : '672245366249588',
		  xfbml      : true,
		  version    : 'v2.6'
		});

		var user_id, accessToken, signedRequest, expiresIn;

		FB.getLoginStatus(function(response){
			accessToken = response.authResponse.accessToken;
			user_id = response.authResponse.userID;
			signedRequest = response.authResponse.signedRequest;
			expiresIn = response.authResponse.expiresIn;

			FB.api("/" + user_id + "/", function(response){
				console.log(response);
			});

			//Once we're logged in do more!
			//Need to condense this into a batch request
			FB.api("/" + user_id + "/picture?width=9999", 
				function(response){
					if (response && !response.error) {
		        		//document.getElementById("reg-user-profile-image").src = response.data.url;
		        		$('.app_user_icon img').attr('src', response.data.url);
		      		}
				}
			);
		});
	}
});

(function(d, s, id){
 var js, fjs = d.getElementsByTagName(s)[0];
 if (d.getElementById(id)) {return;}
 js = d.createElement(s); js.id = id;
 js.src = "static/js/facebook-sdk.js";
 fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));


</script>

<div class="addclass-preview addclass-preview-hide">
	<div class="viewclass_header" align="center">
		<div class="viewclass_header-inner">
			<div class="viewclass_class-category" style="text-transform: uppercase;">Yoga</div>
			<div class="viewclass_class-title">Yoga Sculpting in the Park</div>
		</div>
	</div><!--

	--><div class="viewclass_header2" align="center" style="background-color: red;">
		<div class="viewclass_header2-cell" style="background-color: #555;">
			<div style="margin-bottom: 10px;"><b>When</b></div>
			<p>
			Sunday<br>
			November 31,<br>
			12.30 pm - 1.30 pm
			</p>
		</div><!--
		--><div class="viewclass_header2-cell" style="background-color: #333;">
			<div style="margin-bottom: 10px;"><b>Where</b></div>
			<p>
			Piedmont Park<br>
			10th and Piedmont st.<br>
			Durham, NC 30097
			</p>
		</div>
	</div>

	<div class="viewclass_instructor">
		<div class="viewclass_instructor-cell">
		<b>Your Instructor</b><br>
		Name<br>
		<i>Learn More</i>
		</div>
	</div>
	<br>
	<div style="padding: 20px;">
		<div class="viewclass_white">
			<b>Class Description</b>
			<p id="viewclass_description">
				Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
			</p>
		</div>
		<br>
		<div class="viewclass_white">
			<b>Where to Meet</b>
			<p id="viewclass_meet">
				Meet outside the black bench next to the cobblestone arch.
			</p>
		</div>
	</div>

	<div class="dashboard-footer" style="position: absolute !important;">
		<div class="dashboard-footer-cell" id="edit">
			Edit
		</div><!--
		--><div class="dashboard-footer-cell save">
			Save & Schedule
		</div>
	</div>
	<div style="height: 60px;">
	</div>
</div>

<div class="addclass-edit">
	<a href="/dashboard">
		<div style="position: absolute; top: 10px; left: 15px; color: #FFF; font-weight: bold; font-size: 14px;">
			back
		</div>
	</a>
	<div align="center">
		<span class="app_title" style="margin-top: 10px; display: inline-block; padding-top: 20px; padding-bottom: 20px;">
			ADD CLASS
		</span>
		<div class="app_body" style="padding: 0;">
			<div class="addclass-panel">
				<div style="margin-bottom: 10px;"><b>Select Class Category</b></div>
				<p>
				<%for(var prop in class_data) { %>
					<%if(class_data[prop]['isActive'] >= 1) { %>
					<button 
						class="btn fitted_classpref_button fitted_classpref_button_profile classpref-deselected" 
						class_id='<%=class_data[prop][`id`]%>' 
						style="background-color:#<%=class_data[prop]['color']%>; margin: 10px;">
						<%=class_data[prop]['name']%>
					</button><br>
					<%}%>
				<%}%>
				</p>
			</div>

			<div class="addclass-panel">
				<div style="margin-bottom: 10px;"><b>Class Length in Minutes</b></div>
				<p>
					<button class="addclass_bubble-btn addclass_bubble-btn_selected">30</button>
					<button class="addclass_bubble-btn">45</button>
					<button class="addclass_bubble-btn">60</button><br>
					<button class="addclass_bubble-btn">75</button>
					<button class="addclass_bubble-btn">90</button>
				</p><br>
				<div style="margin-bottom: 10px;"><b>isRepeating</b></div>
				<p>yes/no
				</p>
			</div>

			<div class="addclass-panel">
				<b>Student Payment</b>
				<p>
					<span style="position: relative; left: 3px; bottom: 5px;">$</span><!--
					--><input type="text" class="addclass_inp-underline" value="15.00" maxlength="5" id="class_price"><br>
					<span class="addclass_subtitle">Per Student</span>
				</p><br>

				<b>Number of Students Per Session</b>
				<p>
					<input type="text" class="addclass_inp-underline" value="12" onkeypress="return isNumberKey(event)" maxlength="3" id="numStudents"><br>
					<span class="addclass_subtitle">Maximum Amount</span>
				</p>
			</div>

			<div class="addclass-panel">
				<b>Class Title</b>
				<p>
					<input type="text" class="addclass_inp" value="Yoga Sculpting in the Park" id="class_title">
				</p><br>

				<b>Class Description</b>
				<p>
					<textarea class="addclass_textarea" id="class_description" style="font-size: 18px !important; text-align: left !important;" rows=5>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
					</textarea>
				</p>
			</div>

			<div class="addclass-panel" style="padding-left: 0; padding-right: 0;">
				<div style="margin-bottom: 10px;"><b>Location</b></div>
				<div id="map" style="height: 250px; width: 100%;">
				</div><br>

				<b>Address</b>
				<p>
					<input type="text" class="addclass_inp" value="Piedmont Park" id="address_line1"><br>
					<input type="text" class="addclass_inp" value="10th and Piedmont st." id="address_line2"><br>
					<input type="text" class="addclass_inp" value="Durham, NC. 30097" id="address_line3">
				</p><br>

				<b>Direction Notes</b>
				<p>
					<textarea class="addclass_textarea" id="direction_notes">Meet outside the black bench next to the cobblestone arch.</textarea>
				</p>
			</div>
		</div>
	</div>
	<div class="dashboard-footer">
		<div class="dashboard-footer-cell" id="preview">
			Preview
		</div><!--
		--><div class="dashboard-footer-cell save">
			Save
		</div>
	</div>
</div>
</body>

<div style="height: 60px;">
</div>

<script>
	//google maps code
	function initMap() {
		var piedmont = {lat: 36.1259707, lng: -80.230882};
		var map = new google.maps.Map(document.getElementById('map'), {
		  zoom: 14,
		  center: piedmont,
		  zoomControl: false,
		  scaleControl: false,
		  scrollwheel: false,
		  disableDoubleClickZoom: true,
		});
		var marker = new google.maps.Marker({
		  position: piedmont,
		  map: map
		});
	}

	$(document).ready(function(){
		var class_types = JSON.parse('<%-JSON.stringify(class_preferences)%>');

		//func for getting class data
		function getClassData(){
		var class_category, class_length, address;

		$('.fitted_classpref_button[class_id]').each(function(index, item){
			if($(this).hasClass('classpref-deselected')){
				class_category = null;
			}
			else {
				console.log($(this).attr('class_id'))
				class_category = $(this).attr('class_id');
				return false;
			}
		});

		$('.addclass_bubble-btn').each(function(index, item){
			if($(item).hasClass('addclass_bubble-btn_selected')){
				class_length = parseInt($(this).html());
			}
		});

		address = $('#address_line1') + '&' + $('#address_line2') + '&' + $('#address_line3');

		var class_data = { 
			"category": class_category,
			"length": class_length,
			"price": parseFloat($('#class_price').val()),
			"numStudents": parseInt($('#numStudents').val()),
			"title": $('#class_title').val(),
			"description": $('#class_description').val(),
			"address": address,
			"direction": $('#direction_notes').val(),
		};
		
		return class_data;

		//redirect to /scheduleclass upon success
		}


		//class category behavior
		$('.fitted_classpref_button').mouseup(function(){
			if($(this).hasClass('classpref-deselected')){
				$('.fitted_classpref_button').addClass('classpref-deselected');
				$(this).removeClass('classpref-deselected');
			}
		});

		//class length behavior
		$(".addclass_bubble-btn").mouseup(function(){
			if(!$(this).hasClass('addclass_bubble-btn_selected')){
				//if button isn't already selected, do stuff
				$(".addclass_bubble-btn").removeClass('addclass_bubble-btn_selected');
				$(this).addClass('addclass_bubble-btn_selected');
			}
		});

		//on preview click
		$('#preview').mouseup(function(){
			//update preview
			var preview_data = getClassData();

			$.each(class_types, function(i, val){
				if(val['id'] == preview_data.category){
					$('.viewclass_class-category').html(val['name']);
					$('.viewclass_header').css('background-color', "#" + val['color']);
					return false;
				}
			});

			//update title
			$('.viewclass_class-title').html(preview_data.title);

			//update location

			//update description
			$('#viewclass_description').html(preview_data.description);

			//update where to meet
			$('#viewclass_meet').html(preview_data.direction);

			window.scrollTo(0,0);
			$('.addclass-preview').removeClass('addclass-preview-hide');
			$('.addclass-edit').addClass('hide');
		});

		$('#edit').mouseup(function(){
			window.scrollTo(0,0);
			$('.addclass-preview').addClass('addclass-preview-hide');
			$('.addclass-edit').removeClass('hide');
		});

		var data;

		$('.save').mouseup(function(){
			//saveClass();
			window.location.replace('/scheduleclass');
		});

	});
</script>

<script async defer src ="https://maps.googleapis.com/maps/api/js?key=AIzaSyB7Rdu67ww1V8YOxrLlQkgs_zyr99wXZSs&callback=initMap">
</script>


</html>