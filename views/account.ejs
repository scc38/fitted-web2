<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width; initial-scale = 1.0; maximum-scale=1.0; user-scalable=no" />
	<script src="../static/js/jquery-1.12.4.min.js"></script>
	<script src="../static/js/bootstrap.min.js"></script>
	<link rel="stylesheet" type="text/css" href="../static/css/bootstrap-theme.min.css">
	<link rel="stylesheet" type="text/css" href="../static/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../static/css/font-awesome.min.css">

	<!--google fonts-->
	<link href="https://fonts.googleapis.com/css?family=Quattrocento+Sans" rel="stylesheet">


	<link rel="stylesheet" type="text/css" href="../static/css/style.css">

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../static/js/moment.min.js"></script>

 	<title>FITTED web <%= app_version %></title>
</head>
<body>
<!--facebook code-->
<script>
var isNumberKey = function(evt){
          var charCode = (evt.which) ? evt.which : evt.keyCode;
          if (charCode != 46 && charCode > 31 
            && (charCode < 48 || charCode > 57))
             return false;
          return true;
    }

$(document).ready(function(){

	var statusChangeCallback = function(response){
		console.log(response);
	}

	function checkLoginState() {
		FB.login(function(response){
			console.log(response);
		});
	}

	window.fbAsyncInit = function() {
		FB.init({
		  appId      : '672245366249588',
		  xfbml      : true,
		  version    : 'v2.6'
		});

		var user_id, accessToken, signedRequest, expiresIn;

		FB.getLoginStatus(function(response){
			accessToken = response.authResponse.accessToken;
			user_id = response.authResponse.userID;
			signedRequest = response.authResponse.signedRequest;
			expiresIn = response.authResponse.expiresIn;

			FB.api("/" + user_id + "/", function(response){
				console.log(response);
			});

			//Once we're logged in do more!
			//Need to condense this into a batch request
			FB.api("/" + user_id + "/picture?width=9999", 
				function(response){
					if (response && !response.error) {
		        		//document.getElementById("reg-user-profile-image").src = response.data.url;
		        		$('.app_user_icon img').attr('src', response.data.url);
		      		}
				}
			);
		});
	}
});

(function(d, s, id){
 var js, fjs = d.getElementsByTagName(s)[0];
 if (d.getElementById(id)) {return;}
 js = d.createElement(s); js.id = id;
 js.src = "static/js/facebook-sdk.js";
 fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));


</script>

<div align="center">
	<div class="app_menu">
		<div class="app_user_icon">
			<img>
		</div>

		<span class="app_menu_link" id="menu_profile">Your Profile</span><br>
		<%if (isInstructor >= 1) { %>
		<span class="app_menu_link" id="menu_instructor">Instructor</span><br>
		<% } %>
		<span class="app_menu_link" id="menu_friendCalendar">Your Friends' Calendar</span><br>
		<span class="app_menu_link" id="menu_trainerList">List of Trainers</span><br>
		<span class="app_menu_link" id="menu_upcomingClasses">Upcoming Classes</span><br>
		<span class="app_menu_link" id="menu_classHistory">Class History</span><br>
		<span class="app_menu_link" id="menu_feedback">Give Feedback</span><br>

		<a href="/logout">Logout</a><br>
	</div>

	<div class="app_header" align="center">
		<span class="app_title app_header_left" id="menu_about">Fitted</span>
		<span class="app_title app_header_middle" id="app_title" style="position: absolute; top: 20px;">Upcoming Classes</span>
		<span class="app_title app_header_right" id="app_hamburger">
			<span class="app_menu_icon"><i class="fa fa-bars" aria-hidden="true" id="menu_btn"></i></span>
		</span><br>
		<div id="header_calendar_nav">
			<span class="glyphicon glyphicon-chevron-left header_calendar_nav_arrow" aria-hidden="true" id="date_left"></span>&nbsp;
			<span id="header_date">date</span>
			<span class="glyphicon glyphicon-chevron-right header_calendar_nav_arrow" aria-hidden="true" id="date_right"></span>
		</div>
	</div>

	<div class="app_body">
		<!-- ajax fill in -->
	</div>
</div>
</body>

<script>
	$(document).ready(function(){
		var current_time_view = moment();

		function updateDate(){
			$("#header_date").html( current_time_view.format("dddd MMMM Do, YYYY") );
		}
		updateDate();

		$(".header_calendar_nav_arrow").mouseup(function(){
			if($(this).attr('id') == "date_left"){
				current_time_view = current_time_view.subtract(1, 'days');
			}
			else {
				current_time_view = current_time_view.add(1, 'days');
			}
			updateDate();
		});

		var currentPageMenu = "menu_upcomingClasses";
		function getMenuName(id){
			var page = {
				'name': 'test',
				'html': ''
			};

			switch(id){
				case "menu_profile": 
					page['name'] = "Your Profile";
					page['html'] = "/getprofile/";
					break;
				case "menu_friendCalendar":
					page['name'] = "Your Friends' Calendar";
					page['html'] = "/getfriendscalendar";
					break;
				case "menu_trainerList":
					page['name'] = "List of Trainers";
					page['html'] = "/gettrainerlist";
					break;
				case "menu_upcomingClasses":
					page['name'] = "Upcoming Classes";
					page['html'] = "/getclasses";
					break;
				case "menu_classHistory":
					page['name'] = "Class History";
					page['html'] = "/getclasshistory";
					break;
				case "menu_feedback":
					page['name'] = "Feedback";
					page['html'] = "/getfeedback";
					break;
				case "menu_about":
					page['name'] = "About";
					page['html'] = "/getabout";
				<%if (isInstructor >= 1) { %>
				case "menu_instructor":
					page['name'] = "Instructor";
					page['html'] = "/getinstructor";
				<% } %>
			}
			return page;
		}

		function loadPage(page, isMenu){
			//blabla.html
			$.get(page, function(data){
				$('.app_body').html(data);
				if(currentPageMenu == "menu_upcomingClasses"){
					$('#header_calendar_nav').removeClass("hide");
				}
				else {
					$('#header_calendar_nav').addClass("hide");
					current_time_view = moment(); //Do we want to reset to the current time?
					updateDate();
				}
				/*if(isMenu){
						$(".app_menu").on('transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd', 
					    function() {
					        $('.app_body').addClass('app_body_top');
					    });
					}
				else {
					$('.app_body').addClass('app_body_top');
				}*/
			});
		}

		loadPage('/getclasses', false);
		$('.app_body').addClass('app_body_top');

		$("#app_hamburger").mouseup(function(){
			if(!$('.app_menu').hasClass('show_menu')){
				//display menu
				$('.app_menu').addClass("show_menu");
				$('#app_title').html('Menu')
				$('#menu_btn').removeClass();
				$("#menu_btn").addClass("fa fa-times");
				$('#header_calendar_nav').addClass("hide");
			}
			else {
				//hide menu
				$('.app_menu').removeClass('show_menu');
				$('#app_title').html(getMenuName(currentPageMenu).name);
				$('#menu_btn').removeClass();
				$("#menu_btn").addClass("fa fa-bars");
			}
		});

		$('.app_menu_link, #menu_about').mouseup(function(){
			$('.app_menu').removeClass('show_menu');
			currentPageMenu = $(this).attr('id');
			var page = getMenuName(currentPageMenu);
			//change title, load
			$('#app_title').html(page.name);
			$('#menu_btn').removeClass();
			$("#menu_btn").addClass("fa fa-bars");
			loadPage(page.html, true);
		});
	});
</script>

</html>